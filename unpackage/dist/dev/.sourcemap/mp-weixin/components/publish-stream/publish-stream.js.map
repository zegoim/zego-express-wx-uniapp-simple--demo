{"version":3,"sources":["webpack:////Applications/project/uniapp-simple-sample/components/publish-stream/publish-stream.vue?1505","webpack:////Applications/project/uniapp-simple-sample/components/publish-stream/publish-stream.vue?3fd2","webpack:////Applications/project/uniapp-simple-sample/components/publish-stream/publish-stream.vue?e04e","webpack:////Applications/project/uniapp-simple-sample/components/publish-stream/publish-stream.vue?876a","uni-app:///components/publish-stream/publish-stream.vue"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAuI;AACvI;AACkE;AACL;;;AAG7D;AAC0L;AAC1L,gBAAgB,oMAAU;AAC1B,EAAE,oFAAM;AACR,EAAE,qGAAM;AACR,EAAE,8GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,yGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAA8tB,CAAgB,2uBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;ACclvB;AACA,oD;AACA,mB,CAAA,K,sBAAA,K,CAAA,M,sBAAA,M;AACA;AACA;AACA;AACA,kBADA,EADA;;AAIA;AACA,kBADA,EAJA,EADA;;;AASA,MATA,kBASA;AACA;AACA,uBADA;AAEA,iEAFA;;AAIA,GAdA;AAeA,SAfA,qBAeA;AACA;AACA,kFAFA,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAFA;AAGA;AACA;AACA;AACA,YADA,oBACA,uCADA;AAEA,8BAFA;;AAIA,KALA;AAMA,GAjCA;AAkCA;AACA,YADA,sBACA;AACA,oCADA;AAEA;AACA,6BADA;AAEA,mCAFA;AAGA,mCAHA,IAFA;;;;AASA,kDATA;AAUA,+DAVA,SAUA,KAVA;AAWA;AACA,yCADA,EACA;AACA,2CAFA,CAEA;AAFA,qBAGA;AACA,oCADA,CACA;AADA,mBAHA,CAXA;AAiBA,uEAjBA,gDAiBA,GAjBA,yBAiBA,GAjBA;AAkBA,2CAlBA;AAmBA,KApBA;AAqBA;AACA,qBAtBA,6BAsBA,CAtBA,EAsBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA7BA;AA8BA;AACA,wBA/BA,gCA+BA,CA/BA,EA+BA;AACA;AACA,KAjCA,EAlCA,E","file":"components/publish-stream/publish-stream.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./publish-stream.vue?vue&type=template&id=47f588f8&scoped=true&\"\nvar renderjs\nimport script from \"./publish-stream.vue?vue&type=script&lang=js&\"\nexport * from \"./publish-stream.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"47f588f8\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/publish-stream/publish-stream.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./publish-stream.vue?vue&type=template&id=47f588f8&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./publish-stream.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./publish-stream.vue?vue&type=script&lang=js&\"","<template>\n    <view class=\"publish-stream-content\">\n        <view>推流</view>\n        <live-pusher class=\"testpusher\" v-if=\"livePusherUrl\" :url=\"livePusherUrl\" aspect=\"3:4\"\n            @statechange=\"onPushStateChange\" mode=\"SD\" min-bitrate=\"800\" max-bitrate=\"1500\"\n            @netstatus=\"onPushNetStateChange\" waiting-image=\"https://storage.zego.im/downloads/pause_publish.png\">\n        </live-pusher>\n        <view>\n            <button @tap=\"openRoom\">加入房间并推流</button>\n        </view>\n    </view>\n</template>\n\n<script>\nimport { ZegoExpressEngine } from \"zego-express-engine-miniprogram\"; // 以npm的方式引用\nimport { getLoginToken } from '../../api'\nlet { appID, server } = getApp().globalData\nexport default {\n    props: {\n        roomID: {\n            type: String\n        },\n        pushStreamID: {\n            type: String\n        }\n    },\n    data() {\n        return {\n            livePusherUrl: '',\n            userID: 'user_' + Math.random(10).toString(16) + Date.now()\n        };\n    },\n    created() {\n        // 创建引擎实例\n        this._zg = new ZegoExpressEngine(appID, server) // 不做数据监听，也不必要数据监听，由于数据new ZegoExpressEngine(appID, server) 示例对象过于复杂，监听会报错\n        // 初始化小程序组件实例\n        this._zg.initContext({ wxContext: this })\n        // 在 SDK 的回调 roomStreamUpdate 中获取拉流 streamID\n        // 当用户加入或离开房间时，该事件被触发\n        const _this = this\n        this._zg.on(\"roomStreamUpdate\", (roomID, updateType, streamList) => {\n            console.log(\"roomStreamUpdate\", roomID, updateType, streamList);\n        });\n        // 用户状态更新回调\n        this._zg.on('roomUserUpdate', (roomID, updateType, userList) => {\n            console.warn(\n                `roomUserUpdate: room ${roomID}, user ${updateType === 'ADD' ? 'added' : 'left'} `,\n                JSON.stringify(userList),\n            );\n        });\n    },\n    methods: {\n        async openRoom() {\n            if (!this.roomID.trim()) {\n                uni.showModal({\n                    title: '提示',\n                    content: '请输入房间号',\n                    showCancel: false,\n                });\n                return;\n            }\n            console.log(appID, this.userID)\n            const token = await getLoginToken(appID, this.userID);\n            await this._zg.loginRoom(this.roomID, token, {\n                userID: this.userID, // userID，需用户自己定义，保证全局唯一，建议设置为业务系统中的用户唯一标识\n                userName: this.userID // userName 用户名\n            }, {\n                userUpdate: true // 是否接收用户进出房间的回调，设置为 true 才能接收到房间内其他用户进出房间的回调\n            })\n            const { url } = await this._zg.startPublishingStream(this.pushStreamID)\n            this.livePusherUrl = url\n        },\n        // live-pusher 绑定推流事件，透传推流事件给 SDK\n        onPushStateChange(e) {\n            console.error('onPushStateChange', e.detail.code, e.detail.message);\n            if (e.detail.code === 5000) {\n                this.handupStop = true\n                // this.livePusher && (this.livePusher! as wx.LivePusherContext).stop();\n            }\n            this._zg.updatePlayerState(this.pushStreamID, e);\n        },\n        // live-pusher 绑定网络状态事件，透传网络状态事件给 SDK\n        onPushNetStateChange(e) {\n            this._zg.updatePlayerNetStatus(this.pushStreamID, e);\n        },\n\n    }\n};\n</script>\n\n<style scoped lang=\"scss\">\n</style>\n"],"sourceRoot":""}